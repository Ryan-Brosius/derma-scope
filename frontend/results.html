<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Diagnosis Results</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Custom Styles -->
  <link rel="stylesheet" href="style.css">
  <style>
    /* Mode Switch Label Styles */
    .mode-label {
        font-size: 1.2rem;
        font-weight: bold;
        padding: 5px 15px;
        border-radius: 5px;
        cursor: pointer;
    }
    .active-mode {
        background-color: #007bff;
        color: white;
    }

    /* Diagnosis Box Styles */
    .diagnosis-box {
        background-color: #f8f9fa;
        border: 1px solid var(--primary-color);
        border-radius: 4px;
        padding: 10px;
        text-align: left;
        white-space: pre-wrap; /* Preserve formatting and wrap text */
        overflow: hidden; /* Remove scrollbars */
        min-height: 100px; /* Adjust as needed */
        font-size: 1rem;
        color: var(--text-color);
    }
  </style>
</head>
<body>

  <div id="navbar-container"></div>

  <!-- Results Container -->
  <div class="container mt-5 pt-5">
      <h1 class="text-center">Diagnosis Results</h1>

      <!-- Clickable Mode Switch -->
      <div class="mt-4 d-flex justify-content-center align-items-center">
          <span id="doctorLabel" class="mode-label active-mode" onclick="switchMode('doctor')">Doctor Mode</span>
          <span id="patientLabel" class="mode-label" onclick="switchMode('patient')">Patient Mode</span>
      </div>

      <!-- Doctor Mode Sections -->
      <div id="doctorSections" class="mt-4">
          <div class="mt-4">
              <h2 class="text-center">Diagnosis</h2>
              <div id="doctorDiagnosis" class="form-control diagnosis-box" readonly>
                  Loading diagnosis...
              </div>
          </div>

          <div class="mt-4">
              <h2 class="text-center">Diagnosis Reason</h2>
              <div id="diagnosisReason" class="form-control diagnosis-box" readonly>
                  Loading reasoning...
              </div>
          </div>

          <div class="mt-4">
              <h2 class="text-center">Patient Report</h2>
              <div id="patientReport" class="form-control diagnosis-box" readonly>
                  Generating patient report...
              </div>
          </div>
      </div>

      <!-- Patient Mode Sections -->
      <div id="patientSections" class="mt-4" style="display: none;">
          <div class="mt-4">
              <h2 class="text-center">Diagnosis</h2>
              <div id="patientDiagnosis" class="form-control diagnosis-box" readonly>
                  Loading diagnosis...
              </div>
          </div>

          <div class="mt-4">
              <h2 class="text-center">Treatment Plan</h2>
              <div id="treatmentPlan" class="form-control diagnosis-box" readonly>
                  Loading treatment plan...
              </div>
          </div>
      </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
      // These values should be replaced by your actual GPT-generated responses.
      const doctorDiagnosis = "This is a detailed medical diagnosis, including lesion classification and potential biopsy recommendations.";
      const diagnosisReason = "Medical justification based on observed lesion patterns, risk factors, and differential diagnosis.";
      const patientReport = "A structured report containing key findings, recommendations, and suggested next steps for the patient.";

      const patientDiagnosis = "A simplified explanation of the condition for the patient.";
      const treatmentPlan = "A step-by-step treatment plan for the patient, including medications, home care, and follow-up recommendations.";

      function switchMode(mode) {
          const doctorLabel = document.getElementById("doctorLabel");
          const patientLabel = document.getElementById("patientLabel");

          const doctorSections = document.getElementById("doctorSections");
          const patientSections = document.getElementById("patientSections");

          if (mode === "doctor") {
              doctorSections.style.display = "block";
              patientSections.style.display = "none";

              doctorLabel.classList.add("active-mode");
              patientLabel.classList.remove("active-mode");

              // Update content using stored diagnosis data (if available)
              const diagnosisData = JSON.parse(localStorage.getItem("diagnosisData"));
              document.getElementById("doctorDiagnosis").textContent = diagnosisData ? diagnosisData[0] : doctorDiagnosis;
              document.getElementById("diagnosisReason").textContent = diagnosisData ? diagnosisData[1] : diagnosisReason;
              document.getElementById("patientReport").textContent = diagnosisData ? diagnosisData[2] : patientReport;
          } else {
              doctorSections.style.display = "none";
              patientSections.style.display = "block";

              patientLabel.classList.add("active-mode");
              doctorLabel.classList.remove("active-mode");

              // Update content using stored diagnosis data (if available)
              const diagnosisData = JSON.parse(localStorage.getItem("diagnosisData"));
              document.getElementById("patientDiagnosis").textContent = diagnosisData ? diagnosisData[3] : patientDiagnosis;
              document.getElementById("treatmentPlan").textContent = diagnosisData ? diagnosisData[4] : treatmentPlan;
          }
      }

      // Set default mode to Doctor
      switchMode("doctor");

      // Load the navbar from an external file (navbar.html)
      async function loadNavbar() {
          const response = await fetch("navbar.html");
          const navbarHTML = await response.text();
          document.getElementById("navbar-container").innerHTML = navbarHTML;
      }
      loadNavbar();
  </script>

</body>
</html>
